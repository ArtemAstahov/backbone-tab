/**
 * backbone-tab
 *
 * @author     Naoki Sekiguchi
 * @url        http://likealunatic.jp
 * @license    http://www.opensource.org/licenses/mit-license.html  MIT License
 */
!function(a,b,c){a.Tab=c.View.extend({events:{click:"clickHandler"},initialize:function(c){this.opt={onClassName:"on",defaultIndex:0,effect:!0},b.extend(this.opt,c),// elements
this.$targets=a({}),this.initTarget(),this.$container=this.$targets.parent(),this.$targets.eq(this.opt.defaultIndex).show(),this.render()},render:function(){var b=this;this.$el.each(function(c,d){c===b.opt.defaultIndex?a(d).addClass(b.opt.onClassName):a(d).removeClass(b.opt.onClassName)}),this.watchURI()},initTarget:function(){var b=this;this.$el.each(function(c,d){var e,f=a(d),g=f.attr("href");g=g.slice(g.lastIndexOf("#")),e=a(g).hide(),b.$targets=b.$targets.add(e),f.data("index",c)})},clickHandler:function(a){var b=a.currentTarget;return this.$container.is(":animated")?!1:(this.show(b),this.switchTab(b),void a.preventDefault())},switchTab:function(b){var c=this;this.$el.each(function(d,e){var f=a(e);b===e?f.addClass(c.opt.onClassName):f.removeClass(c.opt.onClassName)})},show:function(b){var c,d=this,e=this.$container.height();this.$targets.each(function(d,e){parseInt(a(b).data("index"),10)===d?(c=e,a(e).css("visibility","hidden").show()):a(e).hide()}),this.opt.effect?// with effect
this.$container.stop(!0,!0).css({overflow:"hidden",height:e}).animate({height:a(c).outerHeight()},350,function(){a(c).hide().css("visibility","visible").fadeIn(),d.$container.css({overflow:"",height:""})}):// no effect
a(c).css("visibility","visible")},watchURI:function(){// initial hash modulation
var a=this.getTargetTabFromURI(location.href);a&&(this.show(a),this.switchTab(a))},getTargetTabFromURI:function(a){var b,c="",d=/#[a-zA-Z0-9\-_]+$/;return d.test(a)?(c=a.slice(a.search(d)),this.$el.each(function(a,e){return"string"!=typeof e.href?!0:void(c===e.href.slice(e.href.search(d))&&(b=e))}),b?b:!1):!1}})}(jQuery,_,Backbone,this,this.document);